<IfModule mod_rewrite.c>
    <IfModule mod_negotiation.c>
        Options -MultiViews -Indexes
    </IfModule>

    RewriteEngine On

    # --- SECURITY: Block access to sensitive files ---
    # Critical: Prevent access to .env, composer.json, etc.
    RewriteRule ^(\.env|\.git|composer\.|package\.|phpunit\.|artisan|README\.md|LICENSE) - [F,L]
    
    # Block access to specific directories
    RewriteRule ^(storage|bootstrap|config|database|resources|routes|tests)/ - [F,L]

    # --- ROUTING: Redirect to public folder ---
    # If the request is not already for public/
    RewriteCond %{REQUEST_URI} !^/public/
    
    # And allow access to the root index.php if needed (optional, but good for fallback)
    # RewriteCond %{REQUEST_FILENAME} !-f
    # RewriteCond %{REQUEST_FILENAME} !-d

    # Rewrite everything to the public folder
    RewriteRule ^(.*)$ public/$1 [L,QSA]
</IfModule>
